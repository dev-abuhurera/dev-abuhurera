name: Generate Sexy Snake Animation

on:
  schedule:
    - cron: "0 */12 * * *"  # Runs every 12 hours
  workflow_dispatch:
  push:
    branches: [ output ]

jobs:
  generate-snake:
    permissions:
      contents: write
    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: Install snk locally
        run: |
          npm install -g @platane/snk

      - name: Generate snake animations
        run: |
          # Light hot-pink snake
          snk generate \
            --user ${{ github.repository_owner }} \
            --out dist/snake.svg \
            --format svg \
            --color-snake "#ff79c6" \
            --color-dots "#bd93f9" \
            --color-empty "#282a36" \
            --color-border "#ffffff20" \
            --effects glow,wave

          # Gold snake
          snk generate \
            --user ${{ github.repository_owner }} \
            --out dist/snake-gold.svg \
            --format svg \
            --color-snake "#ffd700" \
            --color-dots "#ffffff" \
            --color-empty "#1a1a1a" \
            --effects sparkle

      - name: Commit and push output
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add dist/*
          git commit -m "Update snake contributions" || echo "No changes to commit"
          git push origin HEAD:output
